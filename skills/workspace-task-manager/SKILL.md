---
name: workspace-task-manager
description: "This skill should be used when working in a claude-workspace (cw) session to decompose workspace goals into structured tasks, create task directories with phased documents, and orchestrate the superpowers workflow per task. Triggers include: starting a workspace session, decomposing work into tasks, adding new tasks mid-project, or when the user says 'タスク分割', 'task breakdown', 'タスク追加', 'add task'."
---

# Workspace Task Manager

## Overview

Decompose workspace goals into structured, trackable tasks within a claude-workspace (cw) environment. Each task gets its own date-prefixed directory with phased documents that integrate with the superpowers development workflow (brainstorming → writing-plans → execute).

## When to Use

- Starting work in a cw-managed workspace
- Breaking down a project into parallel or sequential tasks
- Adding a new task to an active workspace
- Checking or updating task status across the workspace

## Directory Convention

```
{workspace-root}/
├── CLAUDE.md                          # Workspace context (generated by cw)
├── .workspace.json                    # Workspace config
├── YYYY-MM-DD-{task-name}/            # Task directory
│   ├── task.md                        # Task overview, status, acceptance criteria
│   ├── design.md                      # Brainstorming output (superpowers)
│   ├── plan.md                        # Implementation plan (superpowers)
│   └── notes.md                       # Working notes, decisions, blockers
├── YYYY-MM-DD-{another-task}/
│   ├── task.md
│   └── ...
└── ...
```

**Naming rules:**
- Date prefix: the date the task was created (`YYYY-MM-DD`)
- Task name: lowercase, hyphen-separated, concise (`api-auth`, `data-model-v2`, `bugfix-timeout`)
- Example: `2026-03-01-api-auth/`

## Workflow

### Phase 1: Task Decomposition

When starting a workspace session or when the user requests task breakdown:

1. Read `.workspace.json` and `CLAUDE.md` to understand workspace goals and linked directories
2. Analyze the scope of work — consider each linked directory's role and the workspace description
3. Propose a task list with the following for each task:
   - **Name** (becomes directory name suffix)
   - **Overview** (1-2 sentences)
   - **Target directories** (which linked repos/dirs this task primarily affects)
   - **Priority** (high/medium/low)
   - **Dependencies** (which tasks block or are blocked by this one)
4. Present the task list and get user approval
5. Proceed to Phase 2 for each approved task

### Phase 2: Task Directory Setup

For each approved task:

1. Create the task directory: `{workspace-root}/YYYY-MM-DD-{task-name}/`
2. Generate `task.md` using the template from `references/task-template.md`
   - Fill in all fields based on the decomposition output
   - Set status to `pending`
3. Create empty `notes.md` with a header
4. Update the workspace `CLAUDE.md` — replace the `## Current Tasks` section with a structured task index:

```markdown
## Current Tasks

| Status | Task | Directory | Priority |
|--------|------|-----------|----------|
| pending | API Authentication | `2026-03-01-api-auth/` | high |
| pending | Data Model v2 | `2026-03-01-data-model-v2/` | medium |
```

### Phase 3: Task Execution (per task)

When the user selects a task to work on:

1. Update the task's `task.md` status to `in-progress`
2. Update the workspace `CLAUDE.md` task index accordingly

<CRITICAL>
**Superpowers output path override:** When invoking superpowers skills for a task, override the default `docs/plans/` output paths:

- `superpowers:brainstorming` design doc → save to `{task-dir}/design.md` (NOT `docs/plans/YYYY-MM-DD-*-design.md`)
- `superpowers:writing-plans` plan doc → save to `{task-dir}/plan.md` (NOT `docs/plans/YYYY-MM-DD-*.md`)

Communicate this override to the user before starting the superpowers workflow.
</CRITICAL>

3. Invoke `superpowers:brainstorming` — follow its full process, but save the design document to `{task-dir}/design.md`
4. Invoke `superpowers:writing-plans` — follow its full process, but save the plan to `{task-dir}/plan.md`
5. Execute the plan via superpowers (subagent-driven or parallel session)
6. On completion, update `task.md`:
   - Set status to `completed`
   - Update the Progress Log table
   - Check off acceptance criteria
7. Update workspace `CLAUDE.md` task index

### Phase 4: Task Addition (mid-project)

When a new task emerges during work:

1. Create the new task directory with today's date
2. Generate `task.md` from the template
3. Append the new task to the workspace `CLAUDE.md` task index
4. If the task has dependencies on existing tasks, update both `task.md` files

## Task Status Lifecycle

```
pending → in-progress → completed
                ↓
             blocked (waiting on dependency)
                ↓
           in-progress (unblocked)
```

## Integration with Workspace CLAUDE.md

The workspace `CLAUDE.md` generated by `cw` contains a `## Current Tasks` section. This skill manages that section as the single source of truth for task status overview. The detailed information lives in each task's `task.md`.

When updating the task index in `CLAUDE.md`, preserve all other sections (Linked Repositories, Workflow Rules, Notes) unchanged.

## Key Principles

- **One task, one directory** — all artifacts for a task live together
- **superpowers workflow per task** — each task goes through brainstorming → plan → execute
- **Status in two places** — detailed in `task.md`, summary in workspace `CLAUDE.md`
- **Date prefix for chronology** — tasks are naturally sorted by creation date
- **Incremental** — start with known tasks, add more as they emerge
